<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        <meta name="author" content="Gwilherm Poullennec">
        <link rel="canonical" href="https://docs.inventaire-des-orgues.fr/reprise-technique/">
        <link rel="shortcut icon" href="../img/favicon.ico">
        <title>Aspects techniques - Inventaire des orgues</title>
        <link href="../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../css/font-awesome.min.css" rel="stylesheet">
        <link href="../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
        <link href="../css/extra.css" rel="stylesheet">
        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
        <![endif]-->

        <script src="../js/jquery-1.10.2.min.js" defer></script>
        <script src="../js/bootstrap-3.0.3.min.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script> 
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
            <div class="container">

                <!-- Collapsed navigation -->
                <div class="navbar-header">
                    <!-- Expander button -->
                    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    <a class="navbar-brand" href="..">Inventaire des orgues</a>
                </div>

                <!-- Expanded navigation -->
                <div class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li >
                                <a href="../faq/">Questions/réponses</a>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">Décrire un orgue <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li >
    <a href="../fiche-orgue/">Compléter une fiche</a>
</li>
                                    
<li >
    <a href="../osm/">Localiser un orgue</a>
</li>
                                    
<li >
    <a href="../conventions/">Conventions</a>
</li>
                                    
<li >
    <a href="../permissions/">Permissions</a>
</li>
                                    
<li >
    <a href="../charte-du-contributeur/">Charte du contributeur</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">Origine des données <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li >
    <a href="../donnees_etatcollectivites/">Etat et collectivités</a>
</li>
                                    
<li >
    <a href="../donnees_sites/">Sites Internet</a>
</li>
                                    
<li >
    <a href="../donnees_livres/">Livres d'inventaires</a>
</li>
                                </ul>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav navbar-right">
                        <li>
                            <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li>
                                <a href="https://github.com/inventaire-des-orgues/docs/edit/master/docs/reprise-technique.md"><i class="fa fa-github"></i> Edit on GitHub</a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
                <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
        <li class="main active"><a href="#aspects-techniques">Aspects techniques</a></li>
            <li><a href="#hebergement-de-la-plate-forme">Hébergement de la plate-forme</a></li>
            <li><a href="#langages-frameworks-et-systeme-de-base-de-donnees">Langages, frameworks et système de base de données</a></li>
        <li class="main "><a href="#liste-des-logiciels-libres-utilises">Liste des logiciels libres utilisés</a></li>
            <li><a href="#depots-de-code">Dépôts de code</a></li>
            <li><a href="#services-web-externes">Services web externes</a></li>
            <li><a href="#noms-de-domaine-et-adresses-email-utilisees">Noms de domaine et adresses email utilisées</a></li>
            <li><a href="#synthese-des-services-et-couts-associes">Synthèse des services et coûts associés</a></li>
            <li><a href="#synthese-des-etapes-necessaires-au-tranfert">Synthèse des étapes nécessaires au tranfert</a></li>
            <li><a href="#domaines-sous-domaines-et-services-associes">Domaines, sous-domaines et services associés</a></li>
    </ul>
</div></div>
                <div class="col-md-9" role="main">

<h1 id="aspects-techniques">Aspects techniques</h1>
<h2 id="hebergement-de-la-plate-forme">Hébergement de la plate-forme</h2>
<p>L’application principale est hébergée sur une machine virtuelle louée
chez <em>DigitalOcean</em> et physiquement située à Amsterdam.</p>
<p>L'application annexe de recherche avancées dans les livres d'inventaire numérisés est hébergée sur une autre machine virtuelle, aussi chez <em>DigitalOcean</em>.</p>
<h3 id="sauvegarde-des-donnees">Sauvegarde des données</h3>
<ul>
<li>
<p>Le service DigitalOcean permet une sauvegarde complète de la machine
toutes les semaines (administration, fiches descriptives des orgues, images).</p>
</li>
<li>
<p>Un crontab permet une sauvegarde quotidienne par simple copie sur le serveur de la base de données SQLite (administration et fiches descriptives).</p>
</li>
</ul>
<h3 id="deploiement">Déploiement</h3>
<p>Deux chaînes d'intégration continue (une pour le portail, une autre pour la documentation) sont mises en place.
Elles sont basées sur le module 'Actions' de Github.
La recopie et le déploiement sur le serveur sont déclenchés à chaque action push vers le dépôt distant Github.</p>
<h2 id="langages-frameworks-et-systeme-de-base-de-donnees">Langages, frameworks et système de base de données</h2>
<h3 id="langages-et-frameworks">Langages et frameworks</h3>
<ul>
<li>Le portail est codé en langage Python, en utilisant le framework Django, dédié aux applications web, ainsi que Bootstrap pour les feuilles de style CSS et un peu de Javascript. Les cartes employent Leaflet. Les fonds de cartes proviennent d'OpenStreetMap.</li>
<li>Les utilitaires de traitement des données sont aussi codés en Python.</li>
<li>La documentation est rédigée au format Markdown et compilé sous forme de site web statique à l'aide du module Python Mkdocs.</li>
<li>La reconnaissance de caractères des livres numérisés a été effectuée à l'aide du logiciel non libre ABBYY.</li>
<li>Les fichiers PDF produits ont été manipulés et réagencés à l'aide de l'outil PDFTK et de l'interface graphique PDFTKBuilder.</li>
<li>Les livres numérisés sont proposés sur la plate-forme Datashare.</li>
</ul>
<h3 id="systeme-de-base-de-donnees">Système de base de données</h3>
<p>Le système de base de données utilisé est SQLite.</p>
<h1 id="liste-des-logiciels-libres-utilises">Liste des logiciels libres utilisés</h1>
<ul>
<li>
<p>[DataShare]</p>
</li>
<li>
<p>[Python]</p>
</li>
<li>
<p>[Django]</p>
</li>
<li>
<p>[PDFTK]</p>
</li>
<li>
<p>[PDFTKBuilder]</p>
</li>
<li>
<p><a href="https://www.discourse.org">Discourse</a><br />
    Logiciel libre de forum.</p>
</li>
<li>
<p><a href="https://www.docker.com/">Docker</a><br />
    Logiciel libre pour « containeriser » des services. En l’occurrence,
    Piwik, Discourse et Nextcloud sont lancés sur le serveur depuis
    docker.</p>
</li>
<li>
<p><a href="https://gogs.io/">Gogs</a><br />
    Logiciel libre pour publier une forge de projets sous git.</p>
</li>
<li>
<p><a href="https://jekyllrb.com">Jekyll</a><br />
    Logiciel libre pour construire des blogs en HTML statique.
    Nécessaire de connaître le langage
    <a href="https://fr.wikipedia.org/wiki/Markdown">Markdown</a> pour écrire.</p>
</li>
<li>
<p><a href="https://letsencrypt.org/">Letsencrypt</a><br />
    Service gratuit pour l’obtention de certicats SSL/TLS valides,
    utilisé pour le passage en <code>https</code> de tous les services.</p>
</li>
<li>
<p><a href="https://nextcloud.com/">Nextcloud</a><br />
    Logiciel libre pour le partage de fichiers en ligne.</p>
</li>
<li>
<p><a href="https://piwik.org/">Piwik</a><br />
    Logiciel libre pour la collecte de données sur les visites d’un site
    web.</p>
</li>
</ul>
<h2 id="depots-de-code">Dépôts de code</h2>
<h3 id="depots-principaux-places-sur-github">Dépôts principaux placés sur Github</h3>
<ul>
<li>
<p><a href="https://github.com/inventaire-des-orgues/portail">Portail</a></p>
</li>
<li>
<p><a href="https://github.com/inventaire-des-orgues/docs">Docs</a></p>
</li>
<li>
<p><a href="https://github.com/inventaire-des-orgues/indexes">Indexes</a></p>
</li>
<li>
<p><a href="https://github.com/inventaire-des-orgues/organslist">Organslist</a></p>
</li>
<li>
<p><a href="https://github.com/inventaire-des-orgues/organslexicon">Organslexicon</a></p>
</li>
<li>
<p><a href="https://github.com/inventaire-des-orgues/api">API</a></p>
</li>
</ul>
<h3 id="liste-des-depots-disponibles-depuis-la-forge-du-projet">Liste des dépôts disponibles depuis <em>la forge</em> du projet</h3>
<ul>
<li>
<p><a href="https://git.inventaire-des-orgues.fr/bzg/legito">legito</a><br />
    Code source de l’application d’inventaire des orgues.</p>
</li>
<li>
<p><a href="https://git.inventaire-des-orgues.fr/bzg/rbc-owl">rbc-owl</a><br />
    Code source (<code>rbc-owl.org</code> et <code>rbc-owl.clj</code>) pour la génération d’un
    fichier <code>.owl</code> correspondant au référentiel HADOC.</p>
</li>
<li>
<p><a href="https://git.inventaire-des-orgues.fr/bzg/ox-skos">ox-skos</a><br />
    Code source pour un outil de conversion de fichiers écrits en .org
    vers le format <code>SKOS</code> utilisé pour l’import de vocabulaire dans
    <a href="https://ginco.culture.fr">GINCO</a>.</p>
</li>
<li>
<p><a href="https://git.inventaire-des-orgues.fr/bzg/ghislaine">ghislaine</a><br />
    Code source pour une application de conversion d’un fichier d’export
    Gertrude <code>.zip</code> vers un mini-site web présentant les données du
    fichier.</p>
</li>
<li>
<p><a href="https://git.inventaire-des-orgues.fr/bzg/clj-rgf93-wgs84">clj-rgf93-wgs84</a><br />
    Code source pour une bibliothèque de conversion des coordonnées
    Lambert93 en WGS84.</p>
</li>
<li>
<p><a href="https://git.inventaire-des-orgues.fr/bzg/ido-docs">ido-docs</a><br />
    Code source des informations disponibles sur le site
    <a href="https://docs.inventaire-des-orgues.fr">https://docs.inventaire-des-orgues.fr</a></p>
</li>
<li>
<p><a href="https://git.inventaire-des-orgues.fr/bzg/ido-blog">ido-blog</a><br />
    (Dépôt privé) Code source pour le blog publié sur
    <a href="https://blog.inventaire-des-orgues.fr">https://blog.inventaire-des-orgues.fr</a></p>
</li>
<li>
<p><a href="https://git.inventaire-des-orgues.fr/bzg/ido-web">ido-web</a><br />
    (Dépôt privé) Code source pour le site publié sur
    <a href="https://www.inventaire-des-orgues.fr">https://www.inventaire-des-orgues.fr</a></p>
</li>
</ul>
<h2 id="services-web-externes">Services web externes</h2>
<h3 id="services-utilises-en-dehors-du-logiciel">Services utilisés en dehors du logiciel</h3>
<ul>
<li>
<p>gandi.net  </p>
<p>service de location de noms de domaine.</p>
</li>
<li>
<p>digitalocean.com<br />
    service de location de machines virtuelles.</p>
</li>
<li>
<p>mailchimp.com<br />
    service pour la collecte d’adresses électroniques, ainsi que la
    rédaction et le suivi de lettres d’information.</p>
</li>
<li>
<p>flipmail.co<br />
    service pour faire suivre le contenu d’un formulaire web vers une
    adresse email, utilisé sur le site de présentation principal.</p>
</li>
<li>
<p>tawk.to<br />
    service de discussion en ligne, utilisé sur les sites statiques du
    projet (www/blog/docs).</p>
</li>
</ul>
<h3 id="services-utilises-par-lapplication">Services utilisés par l’application</h3>
<ul>
<li>
<p>mailgun.com<br />
    service d’envoi d’emails utilisé par l’application pour les emails
    transactionnels, par exemple lors de la confirmation lors de
    l’inscription d’un utilisateur.</p>
</li>
<li>
<p>filestack.com<br />
    service d’hébergement de fichiers, utilisé par l’application lorsque
    les contributeurs envoient des fichiers d’images ou autres
    documents.</p>
</li>
</ul>
<h2 id="noms-de-domaine-et-adresses-email-utilisees">Noms de domaine et adresses email utilisées</h2>
<ul>
<li>
<p>inventaire-des-orgues.fr<br />
    nom de domaine principal, utilisé pour le portail et les services
    associés. Pas de service mail actif sur ce nom de domaine depuis
    gandi.net. La zone DNS est gérée par les serveurs DNS de
    digitalocean : <code>ns1.digitalocean.com</code>. Tous les emails envoyés à
    <code>@inventaire-des-orgues.fr</code> sont pour l’instant redirigés vers
    l’adresse du développeur, depuis le service <code>mailgun.com</code>.</p>
</li>
<li>
<p>inventaire-des-orgues.org<br />
    nom de domaine secondaire, utilisé par
    <a href="https://forum.inventaire-des-orgues.fr">https://forum.inventaire-des-orgues.fr</a> pour la passerelle email,
    i.e. la possibilité de répondre par email à un sujet du forum. Deux
    adresses email configurées depuis le compte gandi.net :
    <code>forum@inventaire-des-orgues.org</code> utilisée pour le forum, et
    <code>contact@inventaire-des-orgues.org</code> utilisée pour flipmail.co et
    l’envoi d’information sur le formulaire du site principal.</p>
</li>
</ul>
<h2 id="synthese-des-services-et-couts-associes">Synthèse des services et coûts associés</h2>
<p>| Service          | Coût mensuel (() | Coût annuel ()) | Type d’abonnement |
| ---------------- | ------------------------------------ | ----------------- |
| digitalocean.com | 44                                   | 528               |
| filestack.com    | 49                                   | 588               |
| flipmail.co      | 0                                    | 0                 |
| mailchimp.com    | 0                                    | 0                 |
| mailgun.com      | 0                                    | 0                 |
| tawk.to          | 0                                    | 0                 |
| Total            | 93                                   | 1116              |</p>
<h2 id="synthese-des-etapes-necessaires-au-tranfert">Synthèse des étapes nécessaires au tranfert</h2>
<table>
<thead>
<tr>
<th>Service</th>
<th>Transfert</th>
</tr>
</thead>
<tbody>
<tr>
<td>gandi.net</td>
<td>Transfert du nom de domaine</td>
</tr>
<tr>
<td>mailgun.com</td>
<td>Changement d’adresse de contact et de facturation</td>
</tr>
<tr>
<td>mailchimp.com</td>
<td>Changement d’adresse de contact et de facturation</td>
</tr>
<tr>
<td>digitalocean.com</td>
<td>Changement d’adresse de contact et de facturation</td>
</tr>
<tr>
<td>filestack.com</td>
<td>Changement d’adresse de contact et de facturation</td>
</tr>
</tbody>
</table>
<h2 id="domaines-sous-domaines-et-services-associes">Domaines, sous-domaines et services associés</h2>
<table>
<thead>
<tr>
<th>Sous-domaine</th>
<th>Service</th>
<th>Logiciel associé</th>
</tr>
</thead>
<tbody>
<tr>
<td>www.inventaire-des-orgues.fr</td>
<td>Portail du projet</td>
<td>Jekyll</td>
</tr>
<tr>
<td>blog.inventaire-des-orgues.fr</td>
<td>Blog du projet</td>
<td>Jekyll</td>
</tr>
<tr>
<td>fichiers.inventaire-des-orgues.fr</td>
<td>Fichiers partagés</td>
<td>Nextcloud</td>
</tr>
<tr>
<td>forum.inventaire-des-orgues.fr</td>
<td>Forum</td>
<td>Discourse</td>
</tr>
<tr>
<td>git.inventaire-des-orgues.fr</td>
<td>Dépôt de code</td>
<td>Gogs</td>
</tr>
</tbody>
</table></div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>
            var base_url = "..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../js/base.js" defer></script>
        <script src="../search/main.js" defer></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Search</h4>
            </div>
            <div class="modal-body">
                <p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
                <form role="form">
                    <div class="form-group">
                        <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="Keyboard Shortcuts Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Keyboard Shortcuts</h4>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
